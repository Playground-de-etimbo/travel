# Playwright E2E Testing

## Overview

Playwright E2E tests have been added to ensure the map interactions work correctly.

## Running Tests

```bash
# Run all E2E tests
pnpm test:e2e

# Run with UI mode (interactive)
pnpm test:e2e:ui

# Run in debug mode
pnpm test:e2e:debug
```

## Test Coverage

The test suite (`e2e/map-interactions.spec.ts`) covers:

1. **Add country via map click**
   - Clicks on a country on the map (Canada)
   - Verifies the country appears in the selection bar
   - Confirms localStorage is updated

2. **Remove country via map click**
   - Clicks on a previously added country
   - Confirms removal via the dialog
   - Verifies the country is removed from the bar and storage

3. **Add country via Add button**
   - Opens the Add Country modal
   - Searches for a country (Japan)
   - Adds it via the modal
   - Verifies localStorage is updated

4. **Persistence after reload**
   - Adds a country
   - Reloads the page
   - Confirms the country persists in both UI and storage

## Technical Details

- Uses Chromium browser (headless by default)
- Tests run against dev server at http://localhost:5173
- Dev server starts automatically when tests run
- Uses `page.evaluate()` to dispatch click events for reliable country selection
- Implements `waitForStorage()` helper to handle async localStorage saves

## Storage Key

The app uses `'travel_planner_data'` as the localStorage key (defined in `src/lib/storage/localStorage.ts`).
